<div class="container">
  <div class="page-header">
    <div class="page-header-content">
      <h1 class="page-title">Relatórios</h1>
      <p class="page-subtitle">Análises detalhadas dos seus achievements</p>
    </div>
    <button pButton label="Exportar Dados" icon="pi pi-download" (click)="exportData()" class="btn-export"></button>
  </div>

  <!-- Filtro de Período -->
  <div class="filter-section">
    <div class="filter-card">
      <div class="filter-header">
        <i class="pi pi-calendar-plus filter-icon"></i>
        <h2 class="filter-title">Relatório por Período</h2>
      </div>
      <div class="filter-content">
        <div class="date-inputs">
          <div class="form-field">
            <label class="field-label">Data Início</label>
            <p-datepicker [(ngModel)]="startDate" dateFormat="dd/mm/yy" [showIcon]="true" appendTo="body"
              placeholder="Selecione a data inicial" styleClass="calendar-input"></p-datepicker>
          </div>
          <div class="form-field">
            <label class="field-label">Data Fim</label>
            <p-datepicker [(ngModel)]="endDate" dateFormat="dd/mm/yy" [showIcon]="true" appendTo="body"
              placeholder="Selecione a data final" styleClass="calendar-input"></p-datepicker>
          </div>
        </div>
        <div class="filter-actions">
          <button pButton label="Análise IA" icon="pi pi-sparkles" (click)="generateAISummary()" [loading]="loadingAI()"
            class="p-button-success btn-ai"></button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal de Análise IA (Período) -->
  <p-dialog [(visible)]="showAIModal" [modal]="true" [style]="{width: '90vw', maxWidth: '800px'}" [draggable]="false"
    [resizable]="false" styleClass="ai-modal">
    <ng-template pTemplate="header">
      <div class="modal-header-content">
        <div class="ai-icon-wrapper-modal">
          <i class="pi pi-sparkles"></i>
        </div>
        <div>
          <h2 class="modal-title">Análise Gerada por IA</h2>
          <p class="modal-subtitle">Insights automáticos sobre seus achievements</p>
        </div>
      </div>
    </ng-template>
    <div class="modal-ai-content">
      @if (aiSummary()) {
      <div class="ai-text" [innerHTML]="aiSummary()!.aiGeneratedReport | markdown"></div>
      }
    </div>
  </p-dialog>

  <!-- Modal de Análise GitHub IA -->
  <p-dialog [(visible)]="showGitHubAIModal" [modal]="true" [style]="{width: '90vw', maxWidth: '800px'}"
    [draggable]="false" [resizable]="false" styleClass="ai-modal">
    <ng-template pTemplate="header">
      <div class="modal-header-content">
        <div class="ai-icon-wrapper-modal">
          <i class="pi pi-github"></i>
        </div>
        <div>
          <h2 class="modal-title">Análise GitHub por IA</h2>
          <p class="modal-subtitle">Insights sobre suas contribuições no GitHub</p>
        </div>
      </div>
    </ng-template>
    <div class="modal-ai-content">
      @if (aiGithubAnalysis()) {
      <p class="ai-text" style="white-space: pre-wrap;">{{ aiGithubAnalysis()!.aiAnalysis }}</p>
      }
    </div>
  </p-dialog>
