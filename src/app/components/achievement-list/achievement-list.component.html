<div class="container">
  <div class="page-header">
    <div class="page-header-content">
      <h1 class="page-title">Achievements</h1>
      <p class="page-subtitle">Gerencie seus achievements profissionais</p>
    </div>
    <button pButton (click)="openCreateModal()" label="Novo Achievement" icon="pi pi-plus" class="btn-primary"></button>
  </div>

  <div class="filters-card fade-in">
    <div class="filters-content">
      <div class="search-box">
        <i class="pi pi-search search-icon"></i>
        <input pInputText type="text" [value]="searchText()" (input)="onSearchChange($event)"
          placeholder="Buscar achievements..." class="search-input" />
      </div>

      <p-select [options]="categoriesArray" optionLabel="label" optionValue="value" [formControl]="selectedCategory"
        placeholder="Todas as categorias" [showClear]="true" styleClass="category-dropdown"></p-select>
    </div>
  </div>

  <div class="table-card fade-in">
    <p-table [value]="filteredAchievements()" [loading]="loading()" [paginator]="true" [rows]="10"
      [rowsPerPageOptions]="[5, 10, 25, 50]" styleClass="achievements-table"
      [globalFilterFields]="['title', 'description', 'category']">
      <ng-template pTemplate="header">
        <tr>
          <th class="col-title">Título</th>
          <th class="col-description">Descrição</th>
          <th class="col-date">Data</th>
          <th class="col-category">Categoria</th>
          <th class="col-actions">Ações</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-achievement>
        <tr class="table-row">
          <td class="col-title">
            <div class="achievement-title">{{ achievement.title }}</div>
          </td>
          <td class="col-description">
            <div class="achievement-description">{{ achievement.description }}</div>
          </td>
          <td class="col-date">
            <div class="achievement-date">
              <i class="pi pi-calendar date-icon"></i>
              <span>{{ achievement.date | date: 'dd/MM/yyyy' }}</span>
            </div>
          </td>
          <td class="col-category">
            <p-tag [value]="achievement.category" [severity]="getCategorySeverity(achievement.category)"
              styleClass="category-tag"></p-tag>
          </td>
          <td class="col-actions">
            <div class="action-buttons">
              <button pButton icon="pi pi-pencil" class="p-button-rounded p-button-text action-btn-edit"
                (click)="openEditModal(achievement)" pTooltip="Editar" tooltipPosition="top"></button>
              <button pButton icon="pi pi-trash"
                class="p-button-rounded p-button-text p-button-danger action-btn-delete"
                (click)="deleteAchievement(achievement)" pTooltip="Excluir" tooltipPosition="top"></button>
            </div>
          </td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="6" class="empty-state">
            <div class="empty-content">
              <i class="pi pi-inbox empty-icon"></i>
              <p class="empty-title">Nenhum achievement encontrado</p>
              <p class="empty-description">Tente ajustar os filtros ou crie um novo achievement</p>
            </div>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>

<app-create-achievement-modal [isOpen]="showCreateModal()" [achievementToEdit]="editingAchievement()"
  (onClose)="closeCreateModal()" (onSave)="onAchievementCreated()">
</app-create-achievement-modal>

<p-confirmDialog styleClass="confirm-dialog"></p-confirmDialog>
<p-toast></p-toast>
