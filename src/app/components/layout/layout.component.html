<div class="layout-container">

  <!-- Header -->
  <header class="apple-header">
    <div class="header-content">

      <div class="logo-section">
        <div class="logo-icon">
          <img src="../../../assets/logo-bragdev.png" alt="BragDoc Logo" class="logo-image">
        </div>
        <span class="logo-text">BragDoc</span>
      </div>

      <!-- Desktop nav -->
      <nav class="desktop-nav">
        @for (item of menuItems; track item.label) {
        @if (item.routerLink) {
        <a [routerLink]="item.routerLink" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}"
          class="nav-link" pRipple>
          <i [class]="item.icon"></i>
          <span>{{ item.label }}</span>
        </a>
        } @else if (item.items) {
        <div class="nav-dropdown">
          <button class="nav-link" pRipple>
            <i [class]="item.icon"></i>
            <span>{{ item.label }}</span>
            <i class="pi pi-chevron-down"></i>
          </button>

          <div class="dropdown-content">
            @for (subItem of item.items; track subItem.label) {
            <a [routerLink]="subItem.routerLink" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}"
              class="dropdown-item" pRipple>
              <i [class]="subItem.icon"></i>
              <span>{{ subItem.label }}</span>
            </a>
            }
          </div>
        </div>
        }
        }
      </nav>

      <!-- Actions -->
      <div class="header-actions">
        @if (user(); as u) {
        <div class="user-info">
          <img [src]="u.avatarUrl" [alt]="u.name">
          <div class="user-details">
            <button (click)="logout()" class="logout-btn" pButton label="Sair" icon="pi pi-sign-out" [text]="true"
              [size]="'small'">
            </button>
          </div>
        </div>
        } @else {
        <p-button label="Login" icon="pi pi-github" (onClick)="login()"></p-button>
        }
      </div>

      <!-- Mobile button -->
      <button class="mobile-menu-btn" pButton icon="pi pi-bars" [text]="true" (click)="toggleSidebar()"></button>

    </div>
  </header>

  <!-- Mobile sidebar -->
  <p-drawer [(visible)]="sidebarVisible" position="right" [showCloseIcon]="true" [style]="{ width: '280px' }">

    <ng-template pTemplate="header">
      <div class="sidebar-header">
        <i class="pi pi-trophy"></i>
        <span>BragDoc</span>
      </div>

      @if (user(); as u) {
      <div class="sidebar-user">
        <p-avatar [image]="u.avatarUrl" [label]="u.name.charAt(0).toUpperCase()" shape="circle"
          styleClass="sidebar-avatar-image">
        </p-avatar>
      </div>
      }
    </ng-template>

    <nav class="mobile-nav">
      @for (item of menuItems; track item.label) {
      @if (item.routerLink) {
      <a [routerLink]="item.routerLink" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}"
        class="mobile-nav-item" pRipple (click)="toggleSidebar()">
        <i [class]="item.icon"></i>
        <span>{{ item.label }}</span>
      </a>
      } @else if (item.items) {
      <div class="mobile-nav-group">
        <div class="mobile-nav-group-label">
          <i [class]="item.icon"></i>
          <span>{{ item.label }}</span>
        </div>

        @for (subItem of item.items; track subItem.label) {
        <a [routerLink]="subItem.routerLink" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}"
          class="mobile-nav-subitem" pRipple (click)="toggleSidebar()">
          <i [class]="subItem.icon"></i>
          <span>{{ subItem.label }}</span>
        </a>
        }
      </div>
      }
      }
    </nav>

  </p-drawer>

  <!-- Main -->
  <main class="main-content">
    <router-outlet></router-outlet>
  </main>

  <!-- Footer -->
  <footer class="apple-footer">
    <div class="footer-content">

      <div class="footer-brand">
        <i class="pi pi-trophy"></i>
        <span>BragDoc</span>
        <p class="footer-tagline">Track Your Professional Achievements</p>
      </div>

      <div class="footer-links">
        @for (item of menuItems; track item.label) {
        @if (item.routerLink) {
        <a [routerLink]="item.routerLink" class="footer-link">
          {{ item.label }}
        </a>
        }
        }
      </div>

    </div>

    <div class="footer-bottom">
      <p>Â© 2026 BragDoc. All rights reserved.</p>
    </div>
  </footer>

</div>
